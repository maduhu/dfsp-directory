machine:
  services:
    - docker
  node:
    version: 6.10.1
  postgres:
    version: 9.6.2
  environment:
    UT_ENV: circleci

dependencies:
  pre:
    - curl -u$NPM_USER:$NPM_PASSWORD "https://modusbox.jfrog.io/modusbox/api/npm/level1-npm-release/auth/leveloneproject" >>.npmrc

test:
  override:
    - npm run circleci:test

deployment:
  prod:
    branch: /(^master$)|(^ci_.*)/
    commands:
      - npm run circleci:build
      - npm run circleci:cover
      - npm run circleci:tag
      - npm run circleci:push
